@using Microsoft.AspNetCore.Identity
@inject UserManager<AppUser> UserManager
@{
    var userName = User.Identity.Name;
    var user = UserManager.GetUserAsync(User).Result;
}

@if (!User?.Identity?.IsAuthenticated == true)
{
    <a help data-style="on-hover" hover>–ü–æ–¥–¥–µ—Ä–∂–∫–∞</a>
    <a login-async href="@Url.Action("Login", "Account")" data-style="on-hover" hover>–í–æ–π—Ç–∏</a>
    <a register-async href="@Url.Action("Register", "Account")" data-style="on-hover" hover>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
    <script defer>
        document.addEventListener('DOMContentLoaded', () => {
            const hasLoginContainer = document.querySelector('.__container.login') !== null;

            const loginLink = document.querySelector('a[login-async]');
            const registerLink = document.querySelector('a[register-async]');

            if (!loginLink || !registerLink) return;

            if (hasLoginContainer) {
                loginLink.style.display = 'none';
                registerLink.style.display = 'flex';
            } else {
                loginLink.style.display = 'flex';
                registerLink.style.display = 'none';
            }
        });
    </script>
}
else
{
    <button js-window-profile-btn class="prime none active" hover>@userName</button>
    <div class="js-window visible" js-window-profile>
        <div class="description" hover>
            <div class="block header">
                <h2>–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å:</h2>
            </div>
            <div class="block body">
                <div class="l_block">
                    <img src="~/../assets/icon/logo-banner.webp" alt="logo-main" hover>
                </div>
                <div class="r_block">
                    <div class="header-block">
                        <h2 hover>CodeSpark <span>Prime</span></h2>
                    </div>
                    <div class="body-block">
                        <button notify err-w hover>
                            $notify
                        </button>
                        <button prime-time err-w hover>
                            $time
                        </button>
                        <a help data-style="on-hover" hover>
                            –ü–æ–¥–¥–µ—Ä–∂–∫–∞
                        </a>
                    </div>
                    <div class="footer-block">
                        <a el="stocks" hover>–ê–∫—Ü–∏–∏ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</a>
                        @if (UserManager.IsEmailConfirmedAsync(user).Result is false)
                        {
                            <div class="n_confirm">
                                <a href="@Url.Action("Profile", "Profile")" hover title="–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –≤–∞—à Email –≤ –ø—Ä–æ—Ñ–∏–ª–µ" data-function="send-confirmation-email">–í–∞—à Email –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω!</a>
                            </div>
                        }
                        else
                        {
                            <div class="confirm">
                                <span el="confirm_email" title="–í–∞—à Email –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω. üëç" hover></span>
                            </div>
                        }
                    </div>
                </div>
            </div>
            <div class="block footer">
                <div class="l_block">
                    <a href="@Url.Action("Profile", "Profile")" class="link" hover>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</a>
                    <a tribute err-w hover class="link">Tribute</a>
                </div>
                <div class="r_block">
                    <form asp-action="Logout" asp-controller="Account" method="post" class="logout-form">
                        @Html.AntiForgeryToken()
                        <button type="submit" class="logout-btn" hover>–í—ã—Ö–æ–¥</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
}