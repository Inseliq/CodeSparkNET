@using Microsoft.AspNetCore.Identity
@using CodeSparkNET.Domain.Models;
@inject UserManager<AppUser> UserManager
@{
    var userName = User?.Identity?.Name;
    var user = await UserManager.GetUserAsync(User);
}

@*
    data-load-priority="main" - –≤–º–µ—Å—Ç–µ, –∏–ª–∏
    data-load-priority="addition" - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ,
    —É–ø—Ä–∞–≤–ª—è—é—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏ –≤ partial
*@

@if (User?.Identity?.IsAuthenticated is false)
{
    <a help data-style="on-hover" hover href="@Url.Action("AllSupport", "Help")">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</a>
    <a login-async href="@Url.Action("Login", "Account")" data-style="on-hover" hover>–í–æ–π—Ç–∏</a>
    <a register-async href="@Url.Action("Register", "Account")" data-style="on-hover" hover>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
    <script src="~/../js/style/async.replace-btn.js" defer></script>
}
else
{
    <button js-window-profile-btn class="prime none" hover>@userName</button>
    <div class="js-window hidden" js-window-profile>
        <div class="description" hover>
            <div class="block header">
                <h2>–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å:</h2>
            </div>
            <div class="block body">
                <div class="l_block">
                    <img src="~/../assets/icon/logo-banner.webp" alt="logo-main" hover>
                </div>
                <div class="r_block">
                    <div class="header-block">
                        <h2 hover>CodeSpark <span>Prime</span></h2>
                    </div>
                    <div class="body-block">
                        <button notify err-w hidden="!" hover>
                            $notify
                        </button>
                        <button prime-time err-w hidden="!" hover>
                            $time
                        </button>
                        <a help data-style="on-hover" hover href="@Url.Action("AllSupport", "Help")">
                            –ü–æ–¥–¥–µ—Ä–∂–∫–∞
                        </a>
                    </div>
                    <div class="footer-block">
                        <a el="stocks" hover>–ê–∫—Ü–∏–∏ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</a>
                        @if (await UserManager.IsEmailConfirmedAsync(user) is false)
                        {
                            <div class="n_confirm">
                                <button hover title="–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –≤–∞—à Email –≤ –ø—Ä–æ—Ñ–∏–ª–µ"
                                    data-function="send-confirmation-email">–í–∞—à Email –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω!</button>
                            </div>
                        }
                        else
                        {
                            <div class="confirm">
                                <span el="confirm_email" title="–í–∞—à Email –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω. üëç" hover></span>
                            </div>
                        }
                    </div>
                </div>
            </div>
            <div class="block footer">
                <div class="l_block">
                    <a href="@Url.Action("Profile", "Profile")" class="link" hover>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</a>
                    <a tribute err-w hidden="!" hover class="link">Tribute</a>
                </div>
                <div class="r_block">
                    <form asp-action="Logout" asp-controller="Account" method="post" class="logout-form">
                        @Html.AntiForgeryToken()
                        <button type="submit" class="logout-btn" hover>–í—ã—Ö–æ–¥</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div class="js-window hidden" js-window-send-confirmation-email>
        <div class="description" hover>
            <h2>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∞—à—É –ø–æ—á—Ç—É</h2>
            <a hover data-style="hyper-button" data-function="close-sendConfirmationEmail-btn"><span>–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</span></a>
        </div>
    </div>
    <script src="~/../js/windows/js-window.profile-w.js" defer></script>
    <script src="~/../js/windows/js-window.send-email.js" defer></script>
}

<script src="@(Url.Content("~/js/windows/js-window.err-w.js"))" defer></script>
